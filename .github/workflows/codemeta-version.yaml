name: codemeta-update
defaults:
    run:
      shell: bash
"on":
    workflow_dispatch:
        inputs:
            release_version:
                description: The released version to write into the codemeta.json file
                required: true
                type: string
permissions:
    contents: write
jobs:
    update:
        runs-on: ubuntu-latest
        if: ${{ inputs.release_version }}
        steps:
        - uses: actions/checkout@v4
        - name: Set up Git Config
          run: |
            git config user.name "goreleaserbot"
            git config user.email "<bot@goreleaser.com>"
        - name: Update codemeta.json version in main branch
          uses: jossef/action-set-json-field@v2.1
          with:
            file: codemeta.json
            field: version
            value: "${{ inputs.release_version }}"
        - name: Update codemeta.json
          run: |
            git commit -am "[release] Update codemeta.json version to ${{ inputs.release_version }}"
            git push origin main
